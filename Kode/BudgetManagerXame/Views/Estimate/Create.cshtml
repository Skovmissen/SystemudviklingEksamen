@model BudgetManagerXame.Models.Estimate

@{
    ViewBag.Title = "Create";
}


@using (Html.BeginForm())
{
    <div class="Dropdown_Month">@Html.DropDownListFor(m => m.Period, new SelectList(Model.Period, "Id", "Name"), "Vælg måned", new { @class = "dropdown", @onchange = "SelectionChanged(this.value)" })</div>

    <table class="table-striped">
        <tr>
            <th>

            </th>
            <th>
                @ViewBag.PeriodId
            </th>
        </tr>
        @for (int j = 0; j < Model.FinanceGroup.Count; j++)
        {
            <tr>
                <td>
                    <b>@Model.FinanceGroup[j].Name</b>
                </td>
            </tr>
            for (int i = 0; i < Model.Fap.Count; i++)

            {
                <tr>
                    @if (Model.FinanceAccount[i].FinanceGroup == Model.FinanceGroup[j].Name)
                        {
                        <td>
                            @Model.FinanceAccount[i].Name
                        </td>

                        <td>
                            @Html.EditorFor(m => m.Fap[i].Estimate)
                            @Html.HiddenFor(m => m.Fap[i].BudgetId)
                            @Html.HiddenFor(m => m.Fap[i].PeriodId)
                            @Html.HiddenFor(m => m.Fap[i].AccountId)

                        </td>
                        <td>
                            <input type="hidden" id="budgetId" value="@Model.Fap[i].BudgetId" />
                        </td>
                    }

                </tr>
            }
        }

    </table>
    <input type="submit" value="Opret" class="btn btn-default" />
}
<script>
    function SelectionChanged(val) {
        id = document.getElementById("budgetId").value;
        window.location.href = "/Estimate/Create?budgetId=" + id + "&periodId=" + val;
    }
</script>